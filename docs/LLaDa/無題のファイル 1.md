## **Tá»•ng quan**

Forward process trong LLaDA lÃ  quÃ¡ trÃ¬nh **dáº§n dáº§n che giáº¥u (mask) cÃ¡c token trong cÃ¢u**. ÄÃ¢y lÃ  bÆ°á»›c chuáº©n bá»‹ dá»¯ liá»‡u Ä‘á»ƒ mÃ´ hÃ¬nh há»c cÃ¡ch dá»± Ä‘oÃ¡n cÃ¡c token bá»‹ mask.

## 1. KhÃ¡i niá»‡m

VÃ­ dá»¥

Giáº£ sá»­ cÃ³ cÃ¢u gá»‘c: "HÃ  Ná»™i lÃ  thá»§ Ä‘Ã´ cá»§a Viá»‡t Nam"

- Token gá»‘c: `xâ‚€ = [HÃ , Ná»™i, lÃ , thá»§, Ä‘Ã´, cá»§a, Viá»‡t, Nam]`
- Token Ä‘áº·c biá»‡t: `[MASK]` = token mask

QuÃ¡ trÃ¬nh Forward:

- Táº¡i thá»i Ä‘iá»ƒm `t = 0`: `[HÃ , Ná»™i, lÃ , thá»§, Ä‘Ã´, cá»§a, Viá»‡t, Nam]` (khÃ´ng cÃ³ máº·t náº¡)
- Táº¡i thá»i Ä‘iá»ƒm `t = 0.3`: `[HÃ , [MASK], lÃ , thá»§, Ä‘Ã´, cá»§a, Viá»‡t, Nam]` (1 token bá»‹ che)
- Táº¡i thá»i Ä‘iá»ƒm `t = 0.5`: `[[MASK], [MASK], lÃ , thá»§, Ä‘Ã´, cá»§a, [MASK], Nam]` (3 token bá»‹ che)
- Táº¡i thá»i Ä‘iá»ƒm `t = 0.8`: `[[MASK], [MASK], [MASK], [MASK], Ä‘Ã´, [MASK], [MASK], [MASK]]` (7 token bá»‹ che)
- Táº¡i thá»i Ä‘iá»ƒm `t = 1.0`: `[[MASK], [MASK], [MASK], [MASK], [MASK], [MASK], [MASK], [MASK]]` (táº¥t cáº£ bá»‹ che)

## 2. CÃ´ng thá»©c

**Biáº¿n sá»‘ thá»i gian t**

- `t âˆˆ [0, 1]`: biáº¿n sá»‘ thá»i gian liÃªn tá»¥c
- `t = 0`: tráº¡ng thÃ¡i ban Ä‘áº§u (khÃ´ng cÃ³ **MASK**)
- `t = 1`: tráº¡ng thÃ¡i hoÃ n toÃ n bá»‹ che (táº¥t cáº£ lÃ  **MASK**)

### **PhÃ¢n phá»‘i Ä‘iá»u kiá»‡n cho Má»˜T token**

Äá»‘i vá»›i má»—i token á»Ÿ vá»‹ trÃ­ `i`, xÃ¡c suáº¥t token Ä‘Ã³ bá»‹ che táº¡i thá»i Ä‘iá»ƒm `t` lÃ :

$$ q_{t|0}(x_t^i|x_0^i) = \begin{cases} 1-t, & \text{náº¿u } x_t^i = x_0^i \text{ (giá»¯ nguyÃªn)} \ t, & \text{náº¿u } x_t^i = \mathbf{M} \text{ (bá»‹ che)} \end{cases} $$

**Giáº£i thÃ­ch:**

- XÃ¡c suáº¥t token **giá»¯ nguyÃªn**: `1 - t`
- XÃ¡c suáº¥t token **bá»‹ che**: `t`
- VÃ­ dá»¥: Táº¡i `t = 0.3`, má»—i token cÃ³ 30% kháº£ nÄƒng bá»‹ che, 70% giá»¯ nguyÃªn

### **PhÃ¢n phá»‘i Ä‘iá»u kiá»‡n cho Cáº¢ CÃ‚U**

VÃ¬ cÃ¡c token che **Ä‘á»™c láº­p** nhau, xÃ¡c suáº¥t cá»§a cáº£ cÃ¢u lÃ  **tÃ­ch** cÃ¡c xÃ¡c suáº¥t riÃªng láº»:

$$ q_{t|0}(x_t|x_0) =\prod_{i=1}^{L}q_{t|0}\!\left(x_t^i \mid x_t^0\right) $$

---

## **PHáº¦N 1: KHÃI NIá»†M**

### **1.1. Äá»‹nh nghÄ©a**

**Forward Process** (QuÃ¡ trÃ¬nh Tiáº¿n) lÃ  quÃ¡ trÃ¬nh **dáº§n dáº§n phÃ¡ há»§y thÃ´ng tin** báº±ng cÃ¡ch **thay tháº¿ cÃ¡c token tháº­t báº±ng token máº·t náº¡ [M]**.

**Má»¥c Ä‘Ã­ch:**

- Táº¡o ra dá»¯ liá»‡u huáº¥n luyá»‡n vá»›i cÃ¡c má»©c Ä‘á»™ nhiá»…u khÃ¡c nhau
- GiÃºp mÃ´ hÃ¬nh há»c cÃ¡ch khÃ´i phá»¥c thÃ´ng tin bá»‹ máº¥t
- Cung cáº¥p ná»n táº£ng cho Reverse Process (quÃ¡ trÃ¬nh sinh vÄƒn báº£n)

### **1.2. VÃ­ dá»¥ trá»±c quan**

Giá»‘ng nhÆ° **xÃ³a dáº§n chá»¯ trÃªn báº£ng Ä‘en**:

```
t = 0.0: [HÃ ] [Ná»™i] [lÃ ] [thá»§] [Ä‘Ã´] [Viá»‡t] [Nam]  â† RÃµ rÃ ng 100%
         â†“
t = 0.2: [HÃ ] [Ná»™i] [lÃ ] [M]   [Ä‘Ã´] [Viá»‡t] [Nam]  â† XÃ³a 20%
         â†“
t = 0.5: [HÃ ] [M]   [M]  [M]   [Ä‘Ã´] [M]    [Nam]  â† XÃ³a 50%
         â†“
t = 0.8: [M]  [M]   [M]  [M]   [M]  [M]    [Nam]  â† XÃ³a 80%
         â†“
t = 1.0: [M]  [M]   [M]  [M]   [M]  [M]    [M]    â† XÃ³a 100%

```

### **1.3. CÃ¡c Ä‘áº·c Ä‘iá»ƒm chÃ­nh**

| Äáº·c Ä‘iá»ƒm            | MÃ´ táº£                                                   |
| ------------------- | ------------------------------------------------------- |
| **HÆ°á»›ng**           | Tá»« dá»¯ liá»‡u gá»‘c $x_0$ â†’ dá»¯ liá»‡u nhiá»…u $x_t$              |
| **Thá»i gian**       | $t \in [0, 1]$, tá»« khÃ´ng nhiá»…u Ä‘áº¿n hoÃ n toÃ n nhiá»…u      |
| **TÃ­nh ngáº«u nhiÃªn** | Má»—i token bá»‹ che **Ä‘á»™c láº­p** vá»›i xÃ¡c suáº¥t $t$           |
| **KhÃ´ng há»c**       | ÄÃ¢y lÃ  quÃ¡ trÃ¬nh **cá»‘ Ä‘á»‹nh**, khÃ´ng cÃ³ tham sá»‘ $\theta$ |
| **Äáº£o ngÆ°á»£c Ä‘Æ°á»£c**  | Reverse Process sáº½ há»c cÃ¡ch Ä‘áº£o ngÆ°á»£c quÃ¡ trÃ¬nh nÃ y     |

---

## **PHáº¦N 2: CÃ”NG THá»¨C TOÃN Há»ŒC**

### **2.1. KÃ½ hiá»‡u cÆ¡ báº£n**

|KÃ½ hiá»‡u|Ã nghÄ©a|VÃ­ dá»¥|
|---|---|---|
|$x_0$|CÃ¢u gá»‘c (ground truth)|"TÃ´i yÃªu há»c mÃ¡y"|
|$x_t$|CÃ¢u táº¡i thá»i Ä‘iá»ƒm $t$|"TÃ´i [M] há»c [M]"|
|$t$|Thá»i Ä‘iá»ƒm / tá»· lá»‡ nhiá»…u|$0.5$ = 50% token bá»‹ che|
|$L$|Sá»‘ token trong cÃ¢u|4|
|$x_0^i$|Token thá»© $i$ trong cÃ¢u gá»‘c|"yÃªu" (vá»‹ trÃ­ 2)|
|$x_t^i$|Token thá»© $i$ táº¡i thá»i Ä‘iá»ƒm $t$|[M] hoáº·c token gá»‘c|
|$\mathbf{M}$|Token máº·t náº¡ (mask)|[MASK]|

### **2.2. PhÃ¢n phá»‘i Ä‘iá»u kiá»‡n cho Má»˜T token**

XÃ¡c suáº¥t token thá»© $i$ á»Ÿ tráº¡ng thÃ¡i nÃ o táº¡i thá»i Ä‘iá»ƒm $t$:

$$q_{t|0}(x_t^i|x_0^i) = \begin{cases} 1-t, & \text{náº¿u } x_t^i = x_0^i \text{ (giá»¯ nguyÃªn token gá»‘c)} \ t, & \text{náº¿u } x_t^i = \mathbf{M} \text{ (bá»‹ che thÃ nh máº·t náº¡)} \end{cases}$$

**Giáº£i thÃ­ch:**

- Vá»›i xÃ¡c suáº¥t $1-t$: token **GIá»® NGUYÃŠN**
- Vá»›i xÃ¡c suáº¥t $t$: token **Bá»Š CHE** thÃ nh [M]

**VÃ­ dá»¥ vá»›i $t = 0.3$:**

```
Token gá»‘c: "yÃªu"
â†’ 70% giá»¯ nguyÃªn "yÃªu"
â†’ 30% che thÃ nh [M]

```

### **2.3. PhÃ¢n phá»‘i Ä‘iá»u kiá»‡n cho Cáº¢ CÃ‚U**

VÃ¬ cÃ¡c token che **Ä‘á»™c láº­p** nhau, xÃ¡c suáº¥t cá»§a cáº£ cÃ¢u lÃ  **tÃ­ch** cÃ¡c xÃ¡c suáº¥t riÃªng láº»:

$$q_{t|0}(x_t|x_0) = \prod_{i=1}^L q_{t|0}(x_t^i|x_0^i)$$

**Giáº£i thÃ­ch:**

- $\prod$ nghÄ©a lÃ  "nhÃ¢n táº¥t cáº£"
- XÃ¡c suáº¥t che token 1 **khÃ´ng áº£nh hÆ°á»Ÿng** Ä‘áº¿n xÃ¡c suáº¥t che token 2
- ÄÃ¢y lÃ  giáº£ thiáº¿t **Ä‘á»™c láº­p Ä‘iá»u kiá»‡n**

**VÃ­ dá»¥:**

```
CÃ¢u gá»‘c: xâ‚€ = ["TÃ´i", "yÃªu", "há»c", "mÃ¡y"]
Thá»i Ä‘iá»ƒm: t = 0.5

Káº¿t quáº£ ngáº«u nhiÃªn: xâ‚œ = ["TÃ´i", [M], "há»c", [M]]

XÃ¡c suáº¥t cá»§a káº¿t quáº£ nÃ y:
q(xâ‚œ|xâ‚€) = q("TÃ´i"|"TÃ´i") Ã— q([M]|"yÃªu") Ã— q("há»c"|"há»c") Ã— q([M]|"mÃ¡y")
         = (1-0.5)      Ã— 0.5          Ã— (1-0.5)      Ã— 0.5
         = 0.5          Ã— 0.5          Ã— 0.5          Ã— 0.5
         = 0.0625 = 6.25%

```

### **2.4. Thuáº­t toÃ¡n Forward Process**

```
Äáº¦U VÃ€O:
  - xâ‚€: CÃ¢u gá»‘c vá»›i L tokens
  - t: Thá»i Ä‘iá»ƒm (0 â‰¤ t â‰¤ 1)

Äáº¦U RA:
  - xâ‚œ: CÃ¢u Ä‘Ã£ Ä‘Æ°á»£c che máº·t náº¡

THUáº¬T TOÃN:
1. Khá»Ÿi táº¡o: xâ‚œ = xâ‚€
2. Vá»›i má»—i vá»‹ trÃ­ i tá»« 1 Ä‘áº¿n L:
     a) Sinh sá»‘ ngáº«u nhiÃªn u ~ Uniform(0, 1)
     b) Náº¾U u < t:
          xâ‚œ[i] = [M]        # Che token
        NGÆ¯á»¢C Láº I:
          xâ‚œ[i] = xâ‚€[i]      # Giá»¯ nguyÃªn
3. Tráº£ vá» xâ‚œ

```

---

## **PHáº¦N 3: XÃC SUáº¤T CHI TIáº¾T**

### **3.1. Sá»‘ lÆ°á»£ng token bá»‹ che ká»³ vá»ng**

Vá»›i cÃ¢u dÃ i $L$ tokens vÃ  thá»i Ä‘iá»ƒm $t$:

**Sá»‘ token bá»‹ che trung bÃ¬nh** = $L \times t$

**VÃ­ dá»¥:**

```
CÃ¢u 10 tokens, t = 0.3
â†’ Trung bÃ¬nh 10 Ã— 0.3 = 3 tokens bá»‹ che

CÃ¢u 100 tokens, t = 0.7
â†’ Trung bÃ¬nh 100 Ã— 0.7 = 70 tokens bá»‹ che

```

### **3.2. PhÃ¢n phá»‘i nhá»‹ thá»©c**

Sá»‘ token bá»‹ che chÃ­nh xÃ¡c tuÃ¢n theo **phÃ¢n phá»‘i nhá»‹ thá»©c** $\text{Binomial}(L, t)$:

$$P(\text{cÃ³ Ä‘Ãºng } k \text{ token bá»‹ che}) = \binom{L}{k} t^k (1-t)^{L-k}$$

**VÃ­ dá»¥ vá»›i L=4, t=0.5:**

```
P(0 token bá»‹ che) = C(4,0) Ã— 0.5â° Ã— 0.5â´ = 1 Ã— 1 Ã— 0.0625 = 6.25%
P(1 token bá»‹ che) = C(4,1) Ã— 0.5Â¹ Ã— 0.5Â³ = 4 Ã— 0.5 Ã— 0.125 = 25%
P(2 token bá»‹ che) = C(4,2) Ã— 0.5Â² Ã— 0.5Â² = 6 Ã— 0.25 Ã— 0.25 = 37.5%
P(3 token bá»‹ che) = C(4,3) Ã— 0.5Â³ Ã— 0.5Â¹ = 4 Ã— 0.125 Ã— 0.5 = 25%
P(4 token bá»‹ che) = C(4,4) Ã— 0.5â´ Ã— 0.5â° = 1 Ã— 0.0625 Ã— 1 = 6.25%

```

### **3.3. VÃ­ dá»¥ tÃ­nh xÃ¡c suáº¥t cá»¥ thá»ƒ**

**CÃ¢u gá»‘c:** $x_0 = [\text{AI}, \text{ráº¥t}, \text{máº¡nh}, \text{máº½}]$

**CÃ¢u há»i:** Vá»›i $t=0.6$, xÃ¡c suáº¥t Ä‘á»ƒ Ä‘Æ°á»£c $x_t = [\text{AI}, \mathbf{M}, \mathbf{M}, \text{máº½}]$ lÃ  bao nhiÃªu?

**Giáº£i:**

$$\begin{align} q(x_t|x_0) &= q(\text{AI}|\text{AI}) \times q(\mathbf{M}|\text{ráº¥t}) \times q(\mathbf{M}|\text{máº¡nh}) \times q(\text{máº½}|\text{máº½}) \ &= (1-0.6) \times 0.6 \times 0.6 \times (1-0.6) \ &= 0.4 \times 0.6 \times 0.6 \times 0.4 \ &= 0.0576  \end{align}$$

### **3.4. Giá»›i háº¡n cá»§a Forward Process**

**Khi $t \to 0$:**

- XÃ¡c suáº¥t che â†’ 0
- $x_t \to x_0$ (giá»¯ nguyÃªn hoÃ n toÃ n)

**Khi $t \to 1$:**

- XÃ¡c suáº¥t che â†’ 100%
- $x_t \to [\mathbf{M}, \mathbf{M}, ..., \mathbf{M}]$ (toÃ n máº·t náº¡)

---

## **PHáº¦N 4: CROSS-ENTROPY LOSS**

### **4.1. Má»¥c Ä‘Ã­ch cá»§a Loss Function**

Huáº¥n luyá»‡n mÃ´ hÃ¬nh **dá»± Ä‘oÃ¡n láº¡i $x_0$ tá»« $x_t$** = Há»c cÃ¡ch **khÃ´i phá»¥c thÃ´ng tin bá»‹ máº¥t**.

### **4.2. CÃ´ng thá»©c Loss Ä‘áº§y Ä‘á»§**

$$\mathcal{L}(\theta) \triangleq -\mathbb{E}_{t,x_0,x_t}\left[\frac{1}{t}\sum_{i=1}^L \mathbf{1}[x_t^i = \mathbf{M}]\log p_\theta(x_0^i|x_t)\right]$$

### **4.3. PhÃ¢n tÃ­ch tá»«ng thÃ nh pháº§n**

### **A. $\mathbb{E}_{t,x_0,x_t}[\cdot]$ - Ká»³ vá»ng**

**Láº¥y trung bÃ¬nh** qua nhiá»u máº«u:

**BÆ°á»›c 1:** Láº¥y ngáº«u nhiÃªn cÃ¢u $x_0$ tá»« dá»¯ liá»‡u

```
xâ‚€ ~ p_data(x)
VÃ­ dá»¥: "HÃ´m nay trá»i Ä‘áº¹p"

```

**BÆ°á»›c 2:** Láº¥y ngáº«u nhiÃªn thá»i Ä‘iá»ƒm $t$

```
t ~ Uniform(0, 1)
VÃ­ dá»¥: t = 0.4

```

**BÆ°á»›c 3:** Táº¡o $x_t$ báº±ng Forward Process

```
xâ‚œ ~ q(xâ‚œ|xâ‚€, t)
VÃ­ dá»¥: "HÃ´m [M] trá»i [M]"

```

**BÆ°á»›c 4:** TÃ­nh loss cho máº«u nÃ y, láº·p láº¡i hÃ ng nghÃ¬n láº§n, láº¥y trung bÃ¬nh

### **B. $\sum_{i=1}^L$ - Tá»•ng qua táº¥t cáº£ vá»‹ trÃ­**

Duyá»‡t qua tá»«ng token trong cÃ¢u (vá»‹ trÃ­ 1, 2, 3, ..., L)

### **C. $\mathbf{1}[x_t^i = \mathbf{M}]$ - HÃ m chá»‰ thá»‹**

$$\mathbf{1}[x_t^i = \mathbf{M}] = \begin{cases} 1, & \text{náº¿u token thá»© } i \text{ Bá»Š CHE} \ 0, & \text{náº¿u token thá»© } i \text{ KHÃ”NG bá»‹ che} \end{cases}$$

**Ã nghÄ©a:** CHá»ˆ tÃ­nh loss cho token bá»‹ che, bá» qua token khÃ´ng bá»‹ che.

**LÃ½ do:** Token khÃ´ng bá»‹ che Ä‘Ã£ "lá»™ ra" rá»“i, khÃ´ng cáº§n dá»± Ä‘oÃ¡n ná»¯a.

### **D. $\log p_\theta(x_0^i|x_t)$ - Log xÃ¡c suáº¥t**

- $p_\theta(x_0^i|x_t)$: XÃ¡c suáº¥t mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n token gá»‘c $x_0^i$ tá»« cÃ¢u bá»‹ che $x_t$
- $\theta$: Tham sá»‘ mÃ´ hÃ¬nh (weights cá»§a Transformer)

**VÃ­ dá»¥:**

```
xâ‚œ = "HÃ´m [M] trá»i Ä‘áº¹p"
Vá»‹ trÃ­ bá»‹ che: i = 2
Token gá»‘c: xâ‚€Â² = "nay"

MÃ´ hÃ¬nh dá»± Ä‘oÃ¡n phÃ¢n phá»‘i:
  p_Î¸("nay"|xâ‚œ)  = 0.8    â† ÄÃºng!
  p_Î¸("qua"|xâ‚œ)  = 0.15
  p_Î¸("kia"|xâ‚œ)  = 0.05

â†’ log p_Î¸(xâ‚€Â²|xâ‚œ) = log(0.8) = -0.223

```

### **E. $\frac{1}{t}$ - Há»‡ sá»‘ chuáº©n hÃ³a**

**Váº¥n Ä‘á»:** Khi $t$ lá»›n â†’ nhiá»u token bá»‹ che â†’ nhiá»u token tham gia loss â†’ loss tá»•ng lá»›n

**Giáº£i phÃ¡p:** Chia cho $t$ Ä‘á»ƒ **cÃ¢n báº±ng** Ä‘Ã³ng gÃ³p cá»§a cÃ¡c má»©c Ä‘á»™ nhiá»…u.

**VÃ­ dá»¥ minh há»a:**

```
CÃ¢u 10 tokens:

t = 0.2 â†’ Trung bÃ¬nh 2 tokens bá»‹ che â†’ Sum = 2 Ã— (-log P)
          Loss = (1/0.2) Ã— 2Ã—(...) = 10Ã—(...)

t = 0.8 â†’ Trung bÃ¬nh 8 tokens bá»‹ che â†’ Sum = 8 Ã— (-log P)
          Loss = (1/0.8) Ã— 8Ã—(...) = 10Ã—(...)

â†’ ÄÃ³ng gÃ³p Báº°NG NHAU sau khi nhÃ¢n vá»›i 1/t

```

### **F. Dáº¥u trá»« "-"**

Chuyá»ƒn tá»« **tá»‘i Ä‘a hÃ³a likelihood** sang **tá»‘i thiá»ƒu hÃ³a loss**:

- $p_\theta$ cao (dá»± Ä‘oÃ¡n tá»‘t) â†’ $\log p_\theta$ Ã­t Ã¢m â†’ Loss **NHá»** âœ…
- $p_\theta$ tháº¥p (dá»± Ä‘oÃ¡n kÃ©m) â†’ $\log p_\theta$ ráº¥t Ã¢m â†’ Loss **Lá»šN** âŒ

### **4.4. VÃ­ dá»¥ tÃ­nh Loss cá»¥ thá»ƒ**

### **Thiáº¿t láº­p:**

```
CÃ¢u gá»‘c:    xâ‚€ = [HÃ ,   Ná»™i,  lÃ ,   thá»§,  Ä‘Ã´]     (L=5)
Thá»i Ä‘iá»ƒm:  t = 0.4
CÃ¢u bá»‹ che: xâ‚œ = [HÃ ,   [M],  [M],  thá»§,  Ä‘Ã´]

```

### **BÆ°á»›c 1: XÃ¡c Ä‘á»‹nh token bá»‹ che**

```
i=1: "HÃ "  â†’ KhÃ´ng bá»‹ che â†’ Indicator = 0
i=2: [M]   â†’ Bá»Š CHE       â†’ Indicator = 1 âœ“
i=3: [M]   â†’ Bá»Š CHE       â†’ Indicator = 1 âœ“
i=4: "thá»§" â†’ KhÃ´ng bá»‹ che â†’ Indicator = 0
i=5: "Ä‘Ã´"  â†’ KhÃ´ng bá»‹ che â†’ Indicator = 0

```

### **BÆ°á»›c 2: MÃ´ hÃ¬nh dá»± Ä‘oÃ¡n**

**Vá»‹ trÃ­ i=2 (token gá»‘c = "Ná»™i"):**

```
p_Î¸("Ná»™i"|xâ‚œ) = 0.7
â†’ log(0.7) = -0.357

```

**Vá»‹ trÃ­ i=3 (token gá»‘c = "lÃ "):**

```
p_Î¸("lÃ "|xâ‚œ) = 0.9
â†’ log(0.9) = -0.105

```

### **BÆ°á»›c 3: TÃ­nh tá»•ng**

```
Sum = ğŸ™[i=1] Ã— log(...) + ğŸ™[i=2] Ã— log p(xâ‚€Â²|xâ‚œ) + ğŸ™[i=3] Ã— log p(xâ‚€Â³|xâ‚œ) + ...
    = 0 Ã— (...) + 1 Ã— (-0.357) + 1 Ã— (-0.105) + 0 Ã— (...) + 0 Ã— (...)
    = -0.357 - 0.105
    = -0.462

```

### **BÆ°á»›c 4: NhÃ¢n vá»›i 1/t**

```
(1/t) Ã— Sum = (1/0.4) Ã— (-0.462) = 2.5 Ã— (-0.462) = -1.155

```

### **BÆ°á»›c 5: ThÃªm dáº¥u trá»«**

```
Loss = -(-1.155) = 1.155

```

**Káº¿t quáº£:** Loss cho máº«u nÃ y = **1.155**

### **4.5. Ã nghÄ©a cá»§a Cross-Entropy**

Cross-Entropy Ä‘o **"khoáº£ng cÃ¡ch"** giá»¯a:

- **PhÃ¢n phá»‘i dá»± Ä‘oÃ¡n** cá»§a mÃ´ hÃ¬nh: $p_\theta(x_0^i|x_t)$
- **PhÃ¢n phá»‘i thá»±c táº¿** (one-hot): token Ä‘Ãºng lÃ  $x_0^i$

**Má»¥c tiÃªu huáº¥n luyá»‡n:**

```
Tá»‘i thiá»ƒu hÃ³a Loss
  â†“
Tá»‘i Ä‘a hÃ³a p_Î¸(xâ‚€â±|xâ‚œ) cho token Ä‘Ãºng
  â†“
MÃ´ hÃ¬nh dá»± Ä‘oÃ¡n chÃ­nh xÃ¡c hÆ¡n

```

### **4.6. LiÃªn há»‡ vá»›i LÃ½ thuyáº¿t ThÃ´ng tin**

Cross-Entropy cÅ©ng cÃ³ thá»ƒ hiá»ƒu lÃ :

**"Sá»‘ bit trung bÃ¬nh cáº§n Ä‘á»ƒ mÃ£ hÃ³a token gá»‘c náº¿u dÃ¹ng phÃ¢n phá»‘i dá»± Ä‘oÃ¡n"**

- Dá»± Ä‘oÃ¡n tá»‘t (p cao) â†’ cáº§n Ã­t bit â†’ loss nhá»
- Dá»± Ä‘oÃ¡n kÃ©m (p tháº¥p) â†’ cáº§n nhiá»u bit â†’ loss lá»›n

---

## **PHáº¦N 5: Má»I QUAN Há»† GIá»®A CÃC THÃ€NH PHáº¦N**

### **5.1. SÆ¡ Ä‘á»“ tá»•ng thá»ƒ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         FORWARD PROCESS (Cá»‘ Ä‘á»‹nh)               â”‚
â”‚                                                 â”‚
â”‚  xâ‚€ (gá»‘c) â”€â”€[XÃ¡c suáº¥t t]â”€â”€> xâ‚œ (bá»‹ che)        â”‚
â”‚                                                 â”‚
â”‚  VÃ­ dá»¥: "HÃ  Ná»™i" â”€â”€â”€â”€â”€â”€â”€â”€â”€> "HÃ  [M]"           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Táº¡o dá»¯ liá»‡u huáº¥n luyá»‡nâ”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           MÃ” HÃŒNH (Há»c)                         â”‚
â”‚                                                 â”‚
â”‚  xâ‚œ (input) â”€â”€[Transformer]â”€â”€> p_Î¸(xâ‚€|xâ‚œ)      â”‚
â”‚                                                 â”‚
â”‚  "HÃ  [M]" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> P("Ná»™i") = 0.8   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  TÃ­nh Cross-Entropy   â”‚
        â”‚  Loss Ä‘á»ƒ tá»‘i Æ°u Î¸     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### **5.2. Workflow huáº¥n luyá»‡n**

**1. Forward Process táº¡o máº«u:**

```python
for epoch in range(num_epochs):
    # Láº¥y cÃ¢u tá»« dá»¯ liá»‡u
    x_0 = sample_from_dataset()  # "HÃ  Ná»™i lÃ  thá»§ Ä‘Ã´"

    # Chá»n thá»i Ä‘iá»ƒm ngáº«u nhiÃªn
    t = random.uniform(0, 1)     # 0.6

    # Forward: táº¡o cÃ¢u bá»‹ che
    x_t = forward_process(x_0, t)  # "HÃ  [M] [M] thá»§ Ä‘Ã´"

```

**2. MÃ´ hÃ¬nh dá»± Ä‘oÃ¡n:**

```python
    # MÃ´ hÃ¬nh dá»± Ä‘oÃ¡n token gá»‘c
    predictions = model(x_t, theta)  # PhÃ¢n phá»‘i xÃ¡c suáº¥t

```

**3. TÃ­nh Loss:**

```python
    # Chá»‰ tÃ­nh loss cho token bá»‹ che
    loss = 0
    for i in range(len(x_t)):
        if x_t[i] == MASK:
            loss += -log(predictions[i][x_0[i]])

    loss = loss / t  # Chuáº©n hÃ³a

```

**4. Cáº­p nháº­t mÃ´ hÃ¬nh:**

```python
    # Backpropagation
    gradients = compute_gradients(loss, theta)
    theta = theta - learning_rate * gradients

```

---

### **6.1. Táº¡i sao má»—i token che Ä‘á»™c láº­p?**

**Giáº£ thiáº¿t Ä‘á»™c láº­p** giÃºp:

- ÄÆ¡n giáº£n hÃ³a cÃ´ng thá»©c: $q(x_t|x_0) = \prod_i q(x_t^i|x_0^i)$
- Hiá»‡u quáº£ tÃ­nh toÃ¡n: KhÃ´ng cáº§n tÃ­nh xÃ¡c suáº¥t joint phá»©c táº¡p
- Äá»§ máº¡nh: MÃ´ hÃ¬nh váº«n há»c Ä‘Æ°á»£c dependency tá»« Reverse Process

### **6.2. Táº¡i sao cáº§n há»‡ sá»‘ 1/t?**

KhÃ´ng cÃ³ $1/t$:

- Máº«u vá»›i $t$ lá»›n (nhiá»u mask) sáº½ **chi phá»‘i** loss
- MÃ´ hÃ¬nh sáº½ thiÃªn vá» há»c dá»± Ä‘oÃ¡n tá»« "toÃ n máº·t náº¡" (khÃ³ nháº¥t)
- Máº¥t cÃ¢n báº±ng trong há»c

CÃ³ $1/t$:

- Má»i má»©c Ä‘á»™ nhiá»…u Ä‘Ã³ng gÃ³p **Ä‘á»u nhau**
- MÃ´ hÃ¬nh há»c tá»‘t á»Ÿ **má»i giai Ä‘oáº¡n** (tá»« Ã­t nhiá»…u â†’ nhiá»u nhiá»…u)

---

## **PHáº¦N 7: TÃ“M Táº®T**

### **Forward Process trong 4 cÃ¢u:**

1. **KhÃ¡i niá»‡m:** Dáº§n dáº§n che cÃ¡c token gá»‘c thÃ nh máº·t náº¡ [M] theo thá»i gian $t$
2. **CÃ´ng thá»©c:** $q_{t|0}(x_t^i|x_0^i) = \begin{cases}1-t & \text{giá»¯ nguyÃªn} \ t & \text{che}\end{cases}$
3. **XÃ¡c suáº¥t:** Má»—i token che Ä‘á»™c láº­p, sá»‘ token bá»‹ che ~ Binomial$(L, t)$
4. **Cross-Entropy:** $\mathcal{L}(\theta) = -\mathbb{E}[\frac{1}{t}\sum_i \mathbf{1}[x_t^i=\mathbf{M}]\log p_\theta(x_0^i|x_t)]$

### **Báº£ng tra cá»©u nhanh:**

| ThÃ nh pháº§n                     | CÃ´ng thá»©c                                                     |     |
| ------------------------------ | ------------------------------------------------------------- | --- |
| **XÃ¡c suáº¥t che 1 token**       | $q(x_t^ix_0^i) = t$ náº¿u che                                   |     |
| **XÃ¡c suáº¥t giá»¯ 1 token**       | $q(x_t^ix_0^i) = 1-t$ náº¿u giá»¯                                 |     |
| **XÃ¡c suáº¥t cáº£ cÃ¢u**            | $q(x_tx_0) = \prod_i q(x_t^i)$                                |     |
| **Sá»‘ token bá»‹ che trung bÃ¬nh** | $L \times t$ Vá»›i cÃ¢u $L$ tokens                               |     |
| **Loss cho 1 token**           | $-\log p_\theta(x_0^ix_t)$                                    |     |
| **Loss tá»•ng**                  | $-\frac{1}{t}\sum_{x_t^i=\mathbf{M}} \log p_\theta(x_0^ix_t)$ |     |

---

**Forward Process lÃ  ná»n táº£ng cá»§a LLaDA** - nÃ³ táº¡o ra dá»¯ liá»‡u huáº¥n luyá»‡n Ä‘a dáº¡ng, giÃºp mÃ´ hÃ¬nh há»c cÃ¡ch khÃ´i phá»¥c thÃ´ng tin tá»« ngá»¯ cáº£nh hai chiá»u, tá»« Ä‘Ã³ cÃ³ kháº£ nÄƒng sinh vÄƒn báº£n máº¡nh máº½ vÃ  vÆ°á»£t qua Reversal Curse!